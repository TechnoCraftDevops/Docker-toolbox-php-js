variables:
    IMAGE_TAG: $CI_REGISTRY_IMAGE:$CI_COMMIT_REF_SLUG
  
stages:
    - build

.docker:
    image: docker
    before_script:
      - docker login -u gitlab-ci-token -p $CI_BUILD_TOKEN $CI_REGISTRY
  
build docker image:
    stage: build
    extends: .docker
    script:
      - docker build -t $IMAGE_TAG .
      - docker push $IMAGE_TAG
      - echo "done !"
    only:
      - master
  
